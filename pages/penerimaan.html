<!-- Data Penerimaan Mahasiswa Asing Baru -->
<div class="space-y-6">
  <!-- Stats Overview -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="bg-white rounded-xl shadow p-5 text-center">
      <p class="text-3xl font-bold text-blue-600" id="pendingCount">0</p>
      <p class="text-sm text-gray-500">Menunggu Verifikasi</p>
    </div>
    <div class="bg-white rounded-xl shadow p-5 text-center">
      <p class="text-3xl font-bold text-green-600" id="verifiedCount">0</p>
      <p class="text-sm text-gray-500">Terverifikasi</p>
    </div>
    <div class="bg-white rounded-xl shadow p-5 text-center">
      <p class="text-3xl font-bold text-orange-600" id="processCount">0</p>
      <p class="text-sm text-gray-500">Dalam Proses</p>
    </div>
    <div class="bg-white rounded-xl shadow p-5 text-center">
      <p class="text-3xl font-bold text-purple-600" id="acceptedCount">0</p>
      <p class="text-sm text-gray-500">Diterima</p>
    </div>
  </div>

  <!-- Filter & Import + Upload Excel -->
<div class="bg-white rounded-xl shadow p-4 space-y-4">
  <div
    class="flex flex-col md:flex-row gap-4 items-start md:items-center justify-between"
  >
    <div class="flex flex-wrap gap-3">
      <select
        id="filterStatus"
        class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
      >
        <option value="">Semua Status</option>
        <option value="pending">Menunggu Verifikasi</option>
        <option value="verified">Terverifikasi</option>
        <option value="process">Dalam Proses</option>
        <option value="accepted">Diterima</option>
      </select>

      <input
        type="date"
        id="filterDate"
        class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
    </div>

    <div class="flex gap-2">
      <button
        onclick="exportToExcel()"
        class="px-4 py-2 border border-green-600 text-green-600 rounded-lg hover:bg-green-50 transition"
      >
        ğŸ“Š Export Excel
      </button>

      <label
        class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition cursor-pointer"
      >
        ğŸ“¥ Import Excel
        <input
          type="file"
          id="importExcel"
          accept=".xlsx,.csv"
          class="hidden"
          onchange="handleImport()"
        />
      </label>
    </div>
  </div>

  <!-- Preview Section -->
  <div id="importPreviewSection" class="hidden border-t pt-4">
    <div class="flex justify-between items-center mb-2">
      <p class="font-medium text-sm text-gray-700">
        ğŸ” Preview Data Import
      </p>
      <button
        onclick="uploadToServer()"
        class="px-4 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition"
      >
        âœ… Simpan ke Server
      </button>
    </div>

    <div
      id="previewTable"
      class="max-h-64 overflow-auto border rounded-lg"
    ></div>
  </div>
</div>

  <!-- Applications Table -->
  <div class="bg-white rounded-xl shadow overflow-hidden">
    <div class="overflow-x-auto">
      <table class="w-full text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-3 text-left font-medium text-gray-600">No</th>
            <th class="px-4 py-3 text-left font-medium text-gray-600">
              Nama Pelamar
            </th>
            <th class="px-4 py-3 text-left font-medium text-gray-600">
              Negara
            </th>
            <th class="px-4 py-3 text-left font-medium text-gray-600">
              Prodi Tujuan
            </th>
            <th class="px-4 py-3 text-left font-medium text-gray-600">
              Tanggal Daftar
            </th>
            <th class="px-4 py-3 text-left font-medium text-gray-600">
              Status
            </th>
            <th class="px-4 py-3 text-left font-medium text-gray-600">Aksi</th>
          </tr>
        </thead>
        <tbody id="admissionTableBody" class="divide-y">
          <!-- Dynamic rows from JS -->
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal Detail Penerimaan -->
<div
  id="admissionModal"
  class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50"
>
  <div
    class="bg-white rounded-xl w-full max-w-3xl mx-4 max-h-[90vh] overflow-y-auto"
  >
    <div class="p-5 border-b flex items-center justify-between">
      <h3 class="font-semibold text-lg">Detail Penerimaan</h3>
      <button
        onclick="closeAdmissionModal()"
        class="text-gray-400 hover:text-gray-600 text-xl"
      >
        &times;
      </button>
    </div>
    <div class="p-5 space-y-4">
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-xs font-medium text-gray-500"
            >Nama Lengkap</label
          >
          <p id="admName" class="font-medium">-</p>
        </div>
        <div>
          <label class="block text-xs font-medium text-gray-500"
            >Negara Asal</label
          >
          <p id="admCountry" class="font-medium">-</p>
        </div>
        <div>
          <label class="block text-xs font-medium text-gray-500">Email</label>
          <p id="admEmail" class="font-medium">-</p>
        </div>
        <div>
          <label class="block text-xs font-medium text-gray-500"
            >No. WhatsApp</label
          >
          <p id="admPhone" class="font-medium">-</p>
        </div>
        <div>
          <label class="block text-xs font-medium text-gray-500"
            >Prodi Tujuan</label
          >
          <p id="admProdi" class="font-medium">-</p>
        </div>
        <div>
          <label class="block text-xs font-medium text-gray-500"
            >Tanggal Daftar</label
          >
          <p id="admDate" class="font-medium">-</p>
        </div>
      </div>

      <div>
        <label class="block text-xs font-medium text-gray-500 mb-1"
          >Dokumen Pendukung</label
        >
        <div id="admDocuments" class="space-y-2">
          <!-- Dynamic documents -->
        </div>
      </div>

      <div>
        <label class="block text-xs font-medium text-gray-500 mb-1"
          >Catatan Admin</label
        >
        <textarea
          id="admNote"
          rows="2"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
          placeholder="Tambahkan catatan..."
        ></textarea>
      </div>

      <div>
        <label class="block text-xs font-medium text-gray-500 mb-2"
          >Update Status</label
        >
        <div class="flex flex-wrap gap-2">
          <button
            onclick="updateAdmissionStatus('verified')"
            class="px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded-full hover:bg-green-200 transition"
          >
            âœ… Terverifikasi
          </button>
          <button
            onclick="updateAdmissionStatus('process')"
            class="px-3 py-1.5 text-xs bg-orange-100 text-orange-700 rounded-full hover:bg-orange-200 transition"
          >
            ğŸ”„ Dalam Proses
          </button>
          <button
            onclick="updateAdmissionStatus('accepted')"
            class="px-3 py-1.5 text-xs bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition"
          >
            ğŸ‰ Diterima
          </button>
          <button
            onclick="updateAdmissionStatus('rejected')"
            class="px-3 py-1.5 text-xs bg-red-100 text-red-700 rounded-full hover:bg-red-200 transition"
          >
            âŒ Ditolak
          </button>
        </div>
      </div>
    </div>
    <div class="p-5 border-t flex justify-end">
      <button
        onclick="closeAdmissionModal()"
        class="px-4 py-2 border rounded-lg hover:bg-gray-50"
      >
        Tutup
      </button>
    </div>
  </div>
</div>
